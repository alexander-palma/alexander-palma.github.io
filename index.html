<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alexander Palma</title>
  <style>
    :root{
      --bg:#ffffff;
      --ink:#0f172a; /* slate-900 */
      --muted:#475569; /* slate-600 */
      --line:#e5e7eb; /* gray-200 */
      --link:#2563eb; /* blue-600 */
      --pill:#f1f5f9; /* slate-100 */
      --radius:14px;
      --w:760px; /* columna central */
    }
    html,body{margin:0;background:var(--bg);color:var(--ink);font:400 16px/1.65 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"}
    a{color:var(--link); text-decoration: none}
    a:hover{text-decoration: underline}
    .container{max-width:var(--w); margin:0 auto; padding:0 20px}
    header{border-bottom:1px solid var(--line); background:#fff; position:sticky; top:0; z-index:50}
    .mast{display:flex; align-items:center; gap:18px; padding:18px 0}
    .brand{font-weight:700; letter-spacing:.2px}
    nav ul{list-style:none; margin:0; padding:0; display:flex; gap:14px; flex-wrap:wrap}
    nav a{padding:6px 8px; border-radius:8px}
    nav a[aria-current="page"]{background:var(--pill)}
    main{padding:28px 0}
    h1{font-size:36px; line-height:1.2; margin:12px 0 10px}
    h2{font-size:18px; margin:18px 0 8px}
    .lead{color:var(--muted)}
    .hr{height:1px; background:var(--line); margin:22px 0}

    /* Controles minimalistas */
    label{display:block; font-size:13px; color:var(--muted); margin:8px 0 6px}
    input[type="text"], input[type="url"], input[type="email"], textarea{width:100%; border:1px solid var(--line); border-radius:10px; padding:10px 12px; font:inherit; background:#fff}
    textarea{min-height:120px}
    input[type="file"]{width:100%}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .btn{display:inline-block; padding:8px 14px; border-radius:10px; border:1px solid var(--line); background:#fff; cursor:pointer}
    .btn.primary{background:#111827; color:#fff; border-color:#111827}
    .btn.ghost{background:transparent}

    /* Listas y bloques */
    .list{display:grid; gap:10px; padding:0}
    .item{display:flex; justify-content:space-between; align-items:center; gap:10px; padding:10px 12px; border:1px solid var(--line); border-radius:12px}
    .muted{color:var(--muted)}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}

    /* Secciones (SPA) */
    section{display:none}
    section.active{display:block}

    /* Vista previa */
    .preview{border:1px solid var(--line); border-radius:12px; padding:14px}

    footer{border-top:1px solid var(--line); margin-top:40px; padding:16px 0; color:var(--muted); font-size:14px}

    /* Accesibilidad */
    .skip{position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden}
    .skip:focus{position:static; width:auto; height:auto; padding:8px; background:#fff; border:1px solid var(--line)}
  </style>

  <!-- MathJax: LaTeX en todas las secciones -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] },
      options: { skipHtmlTags: ['script','noscript','style','textarea','pre','code'] }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <!-- Markdown -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <a class="skip" href="#main">Saltar al contenido</a>
  <header>
    <div class="container mast">
      <div class="brand">Alexander Palma</div>
      <nav aria-label="Principal">
        <ul>
          <li><a href="#home" data-nav>Home</a></li>
          <li><a href="#notes" data-nav>Notes</a></li>
          <li><a href="#blog" data-nav>Blog</a></li>
          <li><a href="#contact" data-nav>Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="main" class="container">
    <!-- HOME / ABOUT -->
    <section id="home" class="active" aria-labelledby="home-title">
      <h1 id="home-title">Home</h1>
      <p class="lead">About Me y enlaces/archivos, con soporte LaTeX (ej.: $e^{i\\pi}+1=0$).</p>
      <div class="hr"></div>

      <h2>About Me</h2>
      <label for="about-input">Contenido (Markdown + LaTeX)</label>
      <textarea id="about-input" placeholder="Escribe sobre ti. Puedes usar Markdown y LaTeX."></textarea>
      <div class="row" style="margin-top:8px">
        <button id="about-save" class="btn primary">Guardar</button>
        <button id="about-clear" class="btn ghost">Limpiar</button>
      </div>
      <h2>Vista previa</h2>
      <div id="about-view" class="preview"></div>

      <div class="hr"></div>
      <h2>Enlaces</h2>
      <div class="row">
        <input type="text" id="home-link-label" placeholder="Texto (p.ej., Google Scholar)">
        <input type="url" id="home-link-url" placeholder="https://...">
        <button id="home-add-link" class="btn">Agregar</button>
      </div>
      <div id="home-links" class="list" style="margin-top:10px"></div>

      <h2>Archivos</h2>
      <input type="file" id="home-files" multiple>
      <div id="home-files-list" class="list" style="margin-top:10px"></div>
    </section>

    <!-- NOTES -->
    <section id="notes" aria-labelledby="notes-title">
      <h1 id="notes-title">Notes</h1>
      <p class="lead">Crea notas con contenido, enlaces y archivos. Soporta LaTeX.</p>
      <div class="hr"></div>

      <label for="note-title">Título</label>
      <input type="text" id="note-title" placeholder="Título de la nota">
      <label for="note-content">Contenido (Markdown + LaTeX)</label>
      <textarea id="note-content" placeholder="Escribe la nota. Ej.: $$\\int_0^1 x^2\\,dx=\\tfrac{1}{3}$$"></textarea>

      <h2>Adjuntar enlaces</h2>
      <div class="row">
        <input type="text" id="note-link-label" placeholder="Texto">
        <input type="url" id="note-link-url" placeholder="https://...">
        <button id="note-add-link" class="btn">Añadir enlace</button>
      </div>
      <div id="note-links" class="list" style="margin-top:10px"></div>

      <h2>Adjuntar archivos</h2>
      <input type="file" id="note-files" multiple>
      <div id="note-files-list" class="list" style="margin-top:10px"></div>

      <div class="row" style="margin-top:12px">
        <button id="note-save" class="btn primary">Guardar nota</button>
        <button id="note-clear" class="btn ghost">Limpiar</button>
      </div>

      <div class="hr"></div>
      <h2>Notas guardadas</h2>
      <div id="notes-list" class="list"></div>
    </section>

    <!-- BLOG -->
    <section id="blog" aria-labelledby="blog-title">
      <h1 id="blog-title">Blog</h1>
      <p class="lead">Entradas en Markdown con LaTeX.</p>
      <div class="hr"></div>

      <label for="post-title">Título</label>
      <input type="text" id="post-title" placeholder="Título">
      <label for="post-content">Contenido (Markdown + LaTeX)</label>
      <textarea id="post-content" placeholder="Escribe tu entrada. Ej.: $E=mc^2$"></textarea>
      <div class="row" style="margin-top:8px">
        <button id="post-add" class="btn primary">Publicar</button>
        <button id="post-clear" class="btn ghost">Limpiar</button>
      </div>

      <div class="hr"></div>
      <h2>Entradas</h2>
      <div id="posts-list" class="list"></div>
    </section>

    <!-- CONTACT -->
    <section id="contact" aria-labelledby="contact-title">
      <h1 id="contact-title">Contact</h1>
      <p class="lead">Información de contacto en un formato limpio, similar al ejemplo.</p>
      <div class="hr"></div>

      <h2>Emails</h2>
      <p><span class="mono" id="email1">alexander.palma[at]example[dot]com</span></p>
      <p><span class="mono" id="email2">apalma.math[at]gmail[dot]com</span></p>

      <h2>En la web</h2>
      <p>
        <a href="#" id="link-scholar">Google Scholar</a> ·
        <a href="#" id="link-github">GitHub</a> ·
        <a href="#" id="link-linkedin">LinkedIn</a>
      </p>

      <h2>Enviar un mensaje</h2>
      <div class="row">
        <input type="text" id="contact-name" placeholder="Tu nombre">
        <input type="email" id="contact-email" placeholder="Tu email">
      </div>
      <label for="contact-msg">Mensaje</label>
      <textarea id="contact-msg" placeholder="Hola..."></textarea>
      <div class="row" style="margin-top:8px">
        <button id="contact-send" class="btn primary">Enviar por correo</button>
        <button id="contact-clear" class="btn ghost">Limpiar</button>
      </div>
      <p class="muted" style="margin-top:6px">El botón abrirá tu cliente de correo (<span class="mono">mailto:</span>). Cambia la constante <span class="mono">CONTACT_EMAIL</span> en el script.</p>
    </section>

    <footer>
      <div class="container">© <span id="year"></span> Alexander Palma</div>
    </footer>
  </main>

  <script>
    // ===== Config =====
    const CONTACT_EMAIL = 'alexander.palma@example.com'; // cámbialo

    // ===== Utils =====
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const uid = () => Math.random().toString(36).slice(2) + Date.now().toString(36);
    const J = { load(k, d){ try{ return JSON.parse(localStorage.getItem(k)) ?? d }catch{ return d } }, save(k,v){ localStorage.setItem(k, JSON.stringify(v)); } };
    const readFileAsDataURL = (file) => new Promise((resolve,reject)=>{ const r=new FileReader(); r.onerror=()=>reject(r.error); r.onload=()=>resolve({name:file.name,type:file.type,size:file.size,dataURL:r.result}); r.readAsDataURL(file); });
    function bytes(x){ if(x==null) return ''; const u=['B','KB','MB','GB']; let i=0; while(x>=1024&&i<u.length-1){x/=1024;i++} return x.toFixed(1)+' '+u[i] }
    function md(el, text){ el.innerHTML = marked.parse(text||''); if(window.MathJax&&MathJax.typesetPromise){ MathJax.typesetPromise([el]); } }

    // ===== Estado =====
    const state = {
      about: J.load('about',''),
      homeLinks: J.load('homeLinks',[]),
      homeFiles: J.load('homeFiles',[]),
      notes: J.load('notes',[]), // {id,title,content,links:[{id,label,url}],files:[...],ts}
      posts: J.load('posts',[])  // {id,title,content,ts}
    };

    // ===== Navegación/hash =====
    function setActive(id){ $$('.container section').forEach(s=> s.classList.toggle('active', s.id===id));
      $$('nav a[data-nav]').forEach(a=> a.setAttribute('aria-current', a.getAttribute('href')==='#'+id ? 'page' : null));
      const sec = document.getElementById(id); if(window.MathJax&&MathJax.typesetPromise){ MathJax.typesetPromise([sec]); }
    }
    function onHash(){ const id = location.hash.replace('#','') || 'home'; setActive(id); }
    window.addEventListener('hashchange', onHash);
    document.addEventListener('DOMContentLoaded', onHash);

    // ===== HOME =====
    const aboutInput = document.getElementById('about-input');
    const aboutView = document.getElementById('about-view');
    function renderAbout(){ aboutInput.value = state.about; md(aboutView, state.about); }
    document.getElementById('about-save').onclick = () => { state.about = aboutInput.value; J.save('about', state.about); renderAbout(); };
    document.getElementById('about-clear').onclick = () => { aboutInput.value=''; };

    function renderHomeLinks(){ const c=$('#home-links'); c.innerHTML='';
      if(!state.homeLinks.length){ c.innerHTML='<div class="muted">Aún no hay enlaces.</div>'; return; }
      state.homeLinks.forEach(link=>{
        const li = document.createElement('div'); li.className='item';
        li.innerHTML = `<span><a href="${link.url}" target="_blank" rel="noopener">${link.label||link.url}</a></span>`;
        const del = document.createElement('button'); del.className='btn ghost'; del.textContent='Eliminar';
        del.onclick = ()=>{ state.homeLinks = state.homeLinks.filter(x=>x.id!==link.id); J.save('homeLinks', state.homeLinks); renderHomeLinks(); };
        li.append(del); c.append(li);
      }); }
    document.getElementById('home-add-link').onclick = () => { const label=$('#home-link-label').value.trim(); const url=$('#home-link-url').value.trim(); if(!url) return alert('URL requerida'); state.homeLinks.push({id:uid(),label,url}); J.save('homeLinks', state.homeLinks); $('#home-link-label').value=''; $('#home-link-url').value=''; renderHomeLinks(); };

    async function addHomeFiles(files){ const arr = await Promise.all([...files].map(readFileAsDataURL)); arr.forEach(f=> state.homeFiles.push({id:uid(),...f})); J.save('homeFiles', state.homeFiles); renderHomeFiles(); }
    document.getElementById('home-files').addEventListener('change', (e)=> addHomeFiles(e.target.files));
    function renderHomeFiles(){ const c=$('#home-files-list'); c.innerHTML='';
      if(!state.homeFiles.length){ c.innerHTML='<div class="muted">Aún no hay archivos.</div>'; return; }
      state.homeFiles.forEach(f=>{ const div=document.createElement('div'); div.className='item'; const a=document.createElement('a'); a.href=f.dataURL; a.download=f.name; a.textContent=`${f.name} · ${bytes(f.size)}`; const del=document.createElement('button'); del.className='btn ghost'; del.textContent='Eliminar'; del.onclick=()=>{ state.homeFiles=state.homeFiles.filter(x=>x.id!==f.id); J.save('homeFiles', state.homeFiles); renderHomeFiles(); }; div.append(a,del); c.append(div); }); }

    // ===== NOTES =====
    const tempNote = { links:[], files:[] };
    function renderTempNote(){
      const l=$('#note-links'); l.innerHTML=''; if(!tempNote.links.length){ l.innerHTML='<div class="muted">Sin enlaces.</div>'; }
      tempNote.links.forEach(it=>{ const d=document.createElement('div'); d.className='item'; d.innerHTML=`<span><a href="${it.url}" target="_blank">${it.label||it.url}</a></span>`; const rm=document.createElement('button'); rm.className='btn ghost'; rm.textContent='Quitar'; rm.onclick=()=>{ tempNote.links=tempNote.links.filter(x=>x.id!==it.id); renderTempNote(); }; d.append(rm); l.append(d); });
      const f=$('#note-files-list'); f.innerHTML=''; if(!tempNote.files.length){ f.innerHTML='<div class="muted">Sin archivos.</div>'; }
      tempNote.files.forEach(file=>{ const d=document.createElement('div'); d.className='item'; const a=document.createElement('a'); a.href=file.dataURL; a.download=file.name; a.textContent=`${file.name} · ${bytes(file.size)}`; const rm=document.createElement('button'); rm.className='btn ghost'; rm.textContent='Quitar'; rm.onclick=()=>{ tempNote.files=tempNote.files.filter(x=>x.id!==file.id); renderTempNote(); }; d.append(a,rm); f.append(d); }); }
    document.getElementById('note-add-link').onclick = ()=>{ const label=$('#note-link-label').value.trim(); const url=$('#note-link-url').value.trim(); if(!url) return alert('URL requerida'); tempNote.links.push({id:uid(),label,url}); $('#note-link-label').value=''; $('#note-link-url').value=''; renderTempNote(); };
    document.getElementById('note-files').addEventListener('change', async (e)=>{ const arr=await Promise.all([...e.target.files].map(readFileAsDataURL)); arr.forEach(f=> tempNote.files.push({id:uid(),...f})); renderTempNote(); });

    function renderNotes(){ const c=$('#notes-list'); c.innerHTML=''; if(!state.notes.length){ c.innerHTML='<div class="muted">Aún no has guardado notas.</div>'; return; }
      state.notes.slice().reverse().forEach(n=>{ const wrap=document.createElement('div'); wrap.className='item'; wrap.style.alignItems='start';
        const left=document.createElement('div'); left.style.flex='1';
        const title=document.createElement('div'); title.innerHTML = `<strong>${n.title||'(Sin título)'}</strong>`; left.append(title);
        const content=document.createElement('div'); md(content, n.content); left.append(content);
        if(n.links?.length){ const links=document.createElement('div'); links.style.marginTop='6px'; links.innerHTML='<span class="muted">Enlaces:</span> '; n.links.forEach((it,i)=>{ const a=document.createElement('a'); a.href=it.url; a.target='_blank'; a.textContent = it.label || it.url; links.append(a); if(i<n.links.length-1) links.append(document.createTextNode(' · ')); }); left.append(links); }
        if(n.files?.length){ const files=document.createElement('div'); files.style.marginTop='6px'; files.innerHTML='<span class="muted">Archivos:</span> '; n.files.forEach((f,i)=>{ const a=document.createElement('a'); a.href=f.dataURL; a.download=f.name; a.textContent=f.name; files.append(a); if(i<n.files.length-1) files.append(document.createTextNode(' · ')); }); left.append(files); }
        const del=document.createElement('button'); del.className='btn ghost'; del.textContent='Eliminar'; del.onclick=()=>{ state.notes=state.notes.filter(x=>x.id!==n.id); J.save('notes', state.notes); renderNotes(); };
        wrap.append(left, del); c.append(wrap); }); }

    document.getElementById('note-save').onclick = ()=>{ const title=$('#note-title').value.trim(); const content=$('#note-content').value; state.notes.push({id:uid(), title, content, links:[...tempNote.links], files:[...tempNote.files], ts:Date.now()}); J.save('notes', state.notes); $('#note-title').value=''; $('#note-content').value=''; tempNote.links=[]; tempNote.files=[]; renderTempNote(); renderNotes(); };
    document.getElementById('note-clear').onclick = ()=>{ $('#note-title').value=''; $('#note-content').value=''; tempNote.links=[]; tempNote.files=[]; renderTempNote(); };

    // ===== BLOG =====
    function renderPosts(){ const c=$('#posts-list'); c.innerHTML=''; if(!state.posts.length){ c.innerHTML='<div class="muted">Aún no hay entradas.</div>'; return; }
      state.posts.slice().reverse().forEach(p=>{ const d=document.createElement('div'); d.className='item'; d.style.alignItems='start'; const left=document.createElement('div'); left.style.flex='1'; const title=document.createElement('div'); title.innerHTML = `<strong>${p.title||'(Sin título)'}</strong>`; const when=document.createElement('div'); when.className='muted'; when.style.fontSize='13px'; when.textContent = new Date(p.ts).toLocaleString(); const content=document.createElement('div'); md(content, p.content); left.append(title, when, content); const del=document.createElement('button'); del.className='btn ghost'; del.textContent='Eliminar'; del.onclick=()=>{ state.posts=state.posts.filter(x=>x.id!==p.id); J.save('posts', state.posts); renderPosts(); }; d.append(left, del); c.append(d); }); }
    document.getElementById('post-add').onclick = ()=>{ const title=$('#post-title').value.trim(); const content=$('#post-content').value; if(!title && !content) return alert('Escribe algo'); state.posts.push({id:uid(), title, content, ts:Date.now()}); J.save('posts', state.posts); $('#post-title').value=''; $('#post-content').value=''; renderPosts(); };
    document.getElementById('post-clear').onclick = ()=>{ $('#post-title').value=''; $('#post-content').value=''; };

    // ===== CONTACT =====
    document.getElementById('contact-send').onclick = ()=>{ const name=encodeURIComponent($('#contact-name').value.trim()); const from=encodeURIComponent($('#contact-email').value.trim()); const msg=encodeURIComponent($('#contact-msg').value.trim()); const subject=encodeURIComponent(`[Web] Mensaje de ${name||'Contacto'}`); const body=`De: ${name}%0D%0AEmail: ${from}%0D%0A%0D%0A${msg}`; window.location.href = `mailto:${CONTACT_EMAIL}?subject=${subject}&body=${body}`; };
    document.getElementById('contact-clear').onclick = ()=>{ $('#contact-name').value=''; $('#contact-email').value=''; $('#contact-msg').value=''; };

    // ===== Inicialización =====
    function boot(){ document.getElementById('year').textContent = new Date().getFullYear();
      if(!state.about){ state.about = `Master's student in Mathematics\n\nDesde 2023, soy estudiante del Máster en Matemáticas y Aplicaciones en la Universidad Paris-Saclay, con beca de la Fundación Jacques Hadamard (programa Sophie Germain).`; J.save('about', state.about); }
      renderAbout(); renderHomeLinks(); renderHomeFiles(); renderTempNote(); renderNotes(); renderPosts();
      if(window.MathJax&&MathJax.typesetPromise){ MathJax.typesetPromise(); }
    }
    document.addEventListener('DOMContentLoaded', boot);
  </script>
</body>
</html>
